From dbcd0c521f98e57750243916810b36e921bee0bc Mon Sep 17 00:00:00 2001
From: Dirk Neukirchen <dirkneukirchen@web.de>
Date: Tue, 14 Apr 2015 16:35:14 +0200
Subject: [PATCH 081/158] usbip: fix kernel dir

usbip was moved from staging

Signed-off-by: Dirk Neukirchen <dirkneukirchen@web.de>
---
 net/usbip/Makefile | 14 +++++---------
 1 file changed, 5 insertions(+), 9 deletions(-)

diff --git a/net/usbip/Makefile b/net/usbip/Makefile
index 65e2469..d83340b 100644
--- a/net/usbip/Makefile
+++ b/net/usbip/Makefile
@@ -9,23 +9,24 @@ include $(TOPDIR)/rules.mk
 include $(INCLUDE_DIR)/kernel.mk
 
 PKG_NAME:=usbip
-PKG_RELEASE:=3
+PKG_RELEASE:=4
 
 # Since kernel 2.6.39.1 userspace tools are inside the kernel tree
 # Package Automatic match version in kernel
 # MD5SUM is not useful kernel package already check it
-PKG_VERSION:=$(shell  sed -n -e '/^AC_INIT/s/.*\[\([[:digit:]\.]*\)\].*/\1/gp' $(LINUX_DIR)/drivers/staging/usbip/userspace/configure.ac)
+PKG_VERSION:=$(shell  sed -n -e '/^AC_INIT/s/.*\[\([[:digit:]\.]*\)\].*/\1/gp' $(LINUX_DIR)/tools/usb/usbip/configure.ac)
 PKG_SOURCE:=
 PKG_SOURCE_URL:=
 PKG_MD5SUM:=unknown
 
+PKG_FIXUP:=autoreconf
 PKG_MAINTAINER:=Nuno Goncalves <nunojpg@gmail.com>
 
 PATCH_DIR:=./patches-$(PKG_VERSION)
 
 define prepare_source_directory
 	rm -rf $(PKG_BUILD_DIR)
-	$(CP) $(LINUX_DIR)/drivers/staging/usbip/userspace $(PKG_BUILD_DIR)
+	$(CP) $(LINUX_DIR)/tools/usb/usbip $(PKG_BUILD_DIR)
 endef
 Hooks/Prepare/Pre += prepare_source_directory
 
@@ -39,7 +40,7 @@ include $(INCLUDE_DIR)/nls.mk
 define Package/usbip/Common
   TITLE:=USB-over-IP
   URL:=http://usbip.sourceforge.net/
-  DEPENDS:=@USB_SUPPORT
+  DEPENDS:=@USB_SUPPORT +udev
 endef
 
 define Package/usbip/Default
@@ -71,11 +72,6 @@ MAKE_PATH:=.
 LIBTOOL_PATHS:=.
 MAKE_FLAGS+=CFLAGS="-Wno-implicit-function-declaration"
 
-define Build/Configure
-	(cd $(PKG_BUILD_DIR); ./autogen.sh );
-	$(call Build/Configure/Default)
-endef
-
 CFLAGS+="$(TARGET_CFLAGS) -I$(STAGING_DIR)/usr/include"
 
 define Download/usb.ids
-- 
2.4.0

